.PHONY: dev build test clean help

# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
help:
	@echo "Available commands:"
	@echo "  dev     - ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ã§é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•"
	@echo "  build   - ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç”¨ãƒ“ãƒ«ãƒ‰"
	@echo "  test    - ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ"
	@echo "  clean   - ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã‚’å‰Šé™¤"
	@echo "  help    - ã“ã®ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º"

# ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼
dev:
	@echo "ğŸš€ ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•..."
	@/Users/ohbay/go/bin/air

# ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç”¨ãƒ“ãƒ«ãƒ‰
build:
	@echo "ğŸ”¨ ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç”¨ãƒ“ãƒ«ãƒ‰..."
	@go build -o ./bin/stackies-backend .
	@echo "âœ… ãƒ“ãƒ«ãƒ‰å®Œäº†: ./bin/stackies-backend"

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
test:
	@echo "ğŸ§ª ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ..."
	@go test ./... -v

# ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸
test-coverage:
	@echo "ğŸ“Š ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’è¨ˆæ¸¬..."
	@go test ./... -coverprofile=coverage.out
	@go tool cover -html=coverage.out -o coverage.html
	@echo "âœ… ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆ: coverage.html"

# ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã‚’å‰Šé™¤
clean:
	@echo "ğŸ§¹ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—..."
	@rm -rf ./tmp
	@rm -rf ./bin
	@rm -f build-errors.log
	@rm -f coverage.out
	@rm -f coverage.html
	@echo "âœ… ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†"

# binãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
bin:
	@mkdir -p bin